<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="St. Jude Cloud">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>endedness - ngsderive</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/purebasic.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', "UA-107924368-1", "stjudecloud.github.io/ngsderive");
            ga('send', 'pageview');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">ngsderive</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Subcommands <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../strandedness/" class="dropdown-item">strandedness</a>
</li>
                                    
<li>
    <a href="../instrument/" class="dropdown-item">instrument</a>
</li>
                                    
<li>
    <a href="../readlen/" class="dropdown-item">readlen</a>
</li>
                                    
<li>
    <a href="../encoding/" class="dropdown-item">encoding</a>
</li>
                                    
<li>
    <a href="../junction_annotation/" class="dropdown-item">junction-annotation</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a href="https://github.com/stjudecloud/ngsderive/edit/master/docs/subcommands/endedness.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#endedness" class="nav-link">endedness</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#algorithm" class="nav-link">Algorithm</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#limitations" class="nav-link">Limitations</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="endedness">endedness</h1>
<p>The <code>endedness</code> subcommand determines whether a BAM is made of Single-End or Paired-End reads <strong>according to the BAM specification</strong>. It will return <code>Unknown</code> if the BAM is in an ambiguous or unknown state.
If ngsderive is returning <code>Unknown</code> for a case you believe should be supported, please log an issue on our GitHub with details.</p>
<h2 id="algorithm">Algorithm</h2>
<p>By default, ngsderive will examine the bitwise FLAG field of each read primary or unmapped read in the input BAM or SAM. It keeps a tally of how the bits <code>0x40</code> (first segment in the template) and <code>0x80</code> (last segment in the template) are set.
For Single-End data, both bits should be set for every read. Each read is the only segment in the template, and is therefore both the first and the last segment.
For Paired-End data, <em>exactly</em> half of all reads should be the first in the template (AKA read1, with <code>0x40</code> set) and <em>exactly</em> half should be the last in the template (AKA read2, with <code>0x80</code> set).</p>
<p>With the <code>-r</code> or <code>--calc-rpt</code> option enabled, there is an additional check. ngsderive will count how many primary or unmapped reads belong to each unique query name (Reads-Per-Template, abbreviated RPT).
For Single-End data, RPT should be exactly 1. There should only be one primary or unmapped read mapping to each query name.
For Paired-End data, RPT should be exactly 2. Each query name should be used once for read1 and a second time for read2.
This check has been disabled by default due to its large memory requirements.</p>
<p>The default values for <code>--paired-deviance</code> (<code>0.0</code>) and <code>--round-rpt</code> (<code>False</code>) are suitable only if the default <code>--n-reads</code> (<code>-1</code>) is used. If only a subset of the BAM or SAM file is being processed, please set "paired deviance" to an appropriate 0\&lt;x\&lt;0.5 value and enable RPT rounding. An appropriate value for paired deviance depends on how much of the input file(s) is being processed.</p>
<h2 id="limitations">Limitations</h2>
<p>Many "Single-End" BAMs do not adhere to the SAM file format specification. Specifically, bits <code>0x40</code> and <code>0x80</code> of the bitwise FLAG field are left unset by many aligners. The SAM file format specification details this case as representing a loss of information; therefore ngsderive can make no claims about the endedness of such files.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Â© 2020 St. Jude Children's Research Hospital</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/jquery-3.6.0.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
